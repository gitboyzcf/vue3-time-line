(function(){ try {var elementStyle = document.createElement('style'); elementStyle.appendChild(document.createTextNode(".windowListItem[data-v-35f19113]{width:100%;height:30px;position:relative;border-bottom:1px solid rgb(153,153,153);-webkit-user-select:none;user-select:none}.windowListItem.active[data-v-35f19113]{background-color:var(--427ddd57)}.windowListItem .order[data-v-35f19113]{position:absolute;width:30px;height:30px;display:flex;justify-content:center;align-items:center;color:#fff;border-right:1px solid rgb(153,153,153)}.timeLineContainer[data-v-55d6c60f]{width:100%;height:100%;cursor:pointer;display:flex;flex-direction:column}.timeLineContainer .canvas[data-v-55d6c60f]{flex-grow:0;flex-shrink:0}.timeLineContainer .windowList[data-v-55d6c60f]{width:100%;height:100%;overflow:auto;overflow-x:hidden;border-top:1px solid rgb(153,153,153);display:flex;flex-direction:column}.timeLineContainer .windowList[data-v-55d6c60f]::-webkit-scrollbar{display:none}\n.windowListItem[data-v-35f19113]{width:100%;height:30px;position:relative;border-bottom:1px solid rgb(153,153,153);-webkit-user-select:none;user-select:none}.windowListItem.active[data-v-35f19113]{background-color:var(--427ddd57)}.windowListItem .order[data-v-35f19113]{position:absolute;width:30px;height:30px;display:flex;justify-content:center;align-items:center;color:#fff;border-right:1px solid rgb(153,153,153)}.timeLineContainer[data-v-55d6c60f]{width:100%;height:100%;cursor:pointer;display:flex;flex-direction:column}.timeLineContainer .canvas[data-v-55d6c60f]{flex-grow:0;flex-shrink:0}.timeLineContainer .windowList[data-v-55d6c60f]{width:100%;height:100%;overflow:auto;overflow-x:hidden;border-top:1px solid rgb(153,153,153);display:flex;flex-direction:column}.timeLineContainer .windowList[data-v-55d6c60f]::-webkit-scrollbar{display:none}")); document.head.appendChild(elementStyle);} catch(e) {console.error('vite-plugin-css-injected-by-js', e);} })();(function(Q,m){typeof exports=="object"&&typeof module<"u"?m(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],m):(Q=typeof globalThis<"u"?globalThis:Q||self,m(Q["vue3-time-line"]={},Q.Vue))})(this,function(Q,m){"use strict";var Te=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Me(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var he={exports:{}};(function(a,Z){(function(B,n){a.exports=n()})(Te,function(){var B=1e3,n=6e4,k=36e5,H="millisecond",C="second",M="minute",e="hour",w="day",D="week",I="month",ie="quarter",E="year",N="date",L="Invalid Date",j=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(l){var s=["th","st","nd","rd"],i=l%100;return"["+l+(s[(i-20)%10]||s[i]||s[0])+"]"}},W=function(l,s,i){var u=String(l);return!u||u.length>=s?l:""+Array(s+1-u.length).join(i)+l},X={s:W,z:function(l){var s=-l.utcOffset(),i=Math.abs(s),u=Math.floor(i/60),r=i%60;return(s<=0?"+":"-")+W(u,2,"0")+":"+W(r,2,"0")},m:function l(s,i){if(s.date()<i.date())return-l(i,s);var u=12*(i.year()-s.year())+(i.month()-s.month()),r=s.clone().add(u,I),d=i-r<0,h=s.clone().add(u+(d?-1:1),I);return+(-(u+(i-r)/(d?r-h:h-r))||0)},a:function(l){return l<0?Math.ceil(l)||0:Math.floor(l)},p:function(l){return{M:I,y:E,w:D,d:w,D:N,h:e,m:M,s:C,ms:H,Q:ie}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(l){return l===void 0}},P="en",A={};A[P]=p;var ae="$isDayjsObject",ue=function(l){return l instanceof V||!(!l||!l[ae])},re=function l(s,i,u){var r;if(!s)return P;if(typeof s=="string"){var d=s.toLowerCase();A[d]&&(r=d),i&&(A[d]=i,r=d);var h=s.split("-");if(!r&&h.length>1)return l(h[0])}else{var T=s.name;A[T]=s,r=T}return!u&&r&&(P=r),r||!u&&P},S=function(l,s){if(ue(l))return l.clone();var i=typeof s=="object"?s:{};return i.date=l,i.args=arguments,new V(i)},g=X;g.l=re,g.i=ue,g.w=function(l,s){return S(l,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var V=function(){function l(i){this.$L=re(i.locale,null,!0),this.parse(i),this.$x=this.$x||i.x||{},this[ae]=!0}var s=l.prototype;return s.parse=function(i){this.$d=function(u){var r=u.date,d=u.utc;if(r===null)return new Date(NaN);if(g.u(r))return new Date;if(r instanceof Date)return new Date(r);if(typeof r=="string"&&!/Z$/i.test(r)){var h=r.match(j);if(h){var T=h[2]-1||0,y=(h[7]||"0").substring(0,3);return d?new Date(Date.UTC(h[1],T,h[3]||1,h[4]||0,h[5]||0,h[6]||0,y)):new Date(h[1],T,h[3]||1,h[4]||0,h[5]||0,h[6]||0,y)}}return new Date(r)}(i),this.init()},s.init=function(){var i=this.$d;this.$y=i.getFullYear(),this.$M=i.getMonth(),this.$D=i.getDate(),this.$W=i.getDay(),this.$H=i.getHours(),this.$m=i.getMinutes(),this.$s=i.getSeconds(),this.$ms=i.getMilliseconds()},s.$utils=function(){return g},s.isValid=function(){return this.$d.toString()!==L},s.isSame=function(i,u){var r=S(i);return this.startOf(u)<=r&&r<=this.endOf(u)},s.isAfter=function(i,u){return S(i)<this.startOf(u)},s.isBefore=function(i,u){return this.endOf(u)<S(i)},s.$g=function(i,u,r){return g.u(i)?this[u]:this.set(r,i)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(i,u){var r=this,d=!!g.u(u)||u,h=g.p(i),T=function(G,R){var F=g.w(r.$u?Date.UTC(r.$y,R,G):new Date(r.$y,R,G),r);return d?F:F.endOf(w)},y=function(G,R){return g.w(r.toDate()[G].apply(r.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(R)),r)},x=this.$W,$=this.$M,b=this.$D,z="set"+(this.$u?"UTC":"");switch(h){case E:return d?T(1,0):T(31,11);case I:return d?T(1,$):T(0,$+1);case D:var U=this.$locale().weekStart||0,q=(x<U?x+7:x)-U;return T(d?b-q:b+(6-q),$);case w:case N:return y(z+"Hours",0);case e:return y(z+"Minutes",1);case M:return y(z+"Seconds",2);case C:return y(z+"Milliseconds",3);default:return this.clone()}},s.endOf=function(i){return this.startOf(i,!1)},s.$set=function(i,u){var r,d=g.p(i),h="set"+(this.$u?"UTC":""),T=(r={},r[w]=h+"Date",r[N]=h+"Date",r[I]=h+"Month",r[E]=h+"FullYear",r[e]=h+"Hours",r[M]=h+"Minutes",r[C]=h+"Seconds",r[H]=h+"Milliseconds",r)[d],y=d===w?this.$D+(u-this.$W):u;if(d===I||d===E){var x=this.clone().set(N,1);x.$d[T](y),x.init(),this.$d=x.set(N,Math.min(this.$D,x.daysInMonth())).$d}else T&&this.$d[T](y);return this.init(),this},s.set=function(i,u){return this.clone().$set(i,u)},s.get=function(i){return this[g.p(i)]()},s.add=function(i,u){var r,d=this;i=Number(i);var h=g.p(u),T=function($){var b=S(d);return g.w(b.date(b.date()+Math.round($*i)),d)};if(h===I)return this.set(I,this.$M+i);if(h===E)return this.set(E,this.$y+i);if(h===w)return T(1);if(h===D)return T(7);var y=(r={},r[M]=n,r[e]=k,r[C]=B,r)[h]||1,x=this.$d.getTime()+i*y;return g.w(x,this)},s.subtract=function(i,u){return this.add(-1*i,u)},s.format=function(i){var u=this,r=this.$locale();if(!this.isValid())return r.invalidDate||L;var d=i||"YYYY-MM-DDTHH:mm:ssZ",h=g.z(this),T=this.$H,y=this.$m,x=this.$M,$=r.weekdays,b=r.months,z=r.meridiem,U=function(R,F,te,oe){return R&&(R[F]||R(u,d))||te[F].slice(0,oe)},q=function(R){return g.s(T%12||12,R,"0")},G=z||function(R,F,te){var oe=R<12?"AM":"PM";return te?oe.toLowerCase():oe};return d.replace(Y,function(R,F){return F||function(te){switch(te){case"YY":return String(u.$y).slice(-2);case"YYYY":return g.s(u.$y,4,"0");case"M":return x+1;case"MM":return g.s(x+1,2,"0");case"MMM":return U(r.monthsShort,x,b,3);case"MMMM":return U(b,x);case"D":return u.$D;case"DD":return g.s(u.$D,2,"0");case"d":return String(u.$W);case"dd":return U(r.weekdaysMin,u.$W,$,2);case"ddd":return U(r.weekdaysShort,u.$W,$,3);case"dddd":return $[u.$W];case"H":return String(T);case"HH":return g.s(T,2,"0");case"h":return q(1);case"hh":return q(2);case"a":return G(T,y,!0);case"A":return G(T,y,!1);case"m":return String(y);case"mm":return g.s(y,2,"0");case"s":return String(u.$s);case"ss":return g.s(u.$s,2,"0");case"SSS":return g.s(u.$ms,3,"0");case"Z":return h}return null}(R)||h.replace(":","")})},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(i,u,r){var d,h=this,T=g.p(u),y=S(i),x=(y.utcOffset()-this.utcOffset())*n,$=this-y,b=function(){return g.m(h,y)};switch(T){case E:d=b()/12;break;case I:d=b();break;case ie:d=b()/3;break;case D:d=($-x)/6048e5;break;case w:d=($-x)/864e5;break;case e:d=$/k;break;case M:d=$/n;break;case C:d=$/B;break;default:d=$}return r?d:g.a(d)},s.daysInMonth=function(){return this.endOf(I).$D},s.$locale=function(){return A[this.$L]},s.locale=function(i,u){if(!i)return this.$L;var r=this.clone(),d=re(i,u,!0);return d&&(r.$L=d),r},s.clone=function(){return g.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},l}(),le=V.prototype;return S.prototype=le,[["$ms",H],["$s",C],["$m",M],["$H",e],["$W",w],["$M",I],["$y",E],["$D",N]].forEach(function(l){le[l[1]]=function(s){return this.$g(s,l[0],l[1])}}),S.extend=function(l,s){return l.$i||(l(s,V,S),l.$i=!0),S},S.locale=re,S.isDayjs=ue,S.unix=function(l){return S(1e3*l)},S.en=A[P],S.Ls=A,S.p={},S})})(he);var ve=he.exports;const K=Me(ve),Oe="",fe=(a,Z)=>{const B=a.__vccOpts||a;for(const[n,k]of Z)B[n]=k;return B},ye={class:"order"},Se=fe(Object.assign({name:"WindowListItem"},{__name:"WindowListItem",props:{index:{type:Number},data:{type:Object,default(){return{}}},totalMS:{type:Number},startTimestamp:{type:Number},width:{type:Number},active:{type:Boolean,default:!1},multiSegmentActiveColor:{type:String,default:"#333"}},emits:["click","click_window_timeSegments"],setup(a,{expose:Z,emit:B}){m.useCssVars(L=>({"427ddd57":L.multiSegment}));const n=a,k=B,H=m.ref(null),C=m.ref(null),M=m.reactive({height:0,ctx:null}),e=()=>{let{height:L}=H.value.getBoundingClientRect();M.height=L-1,C.value.width=n.width,C.value.height=M.height,M.ctx=C.value.getContext("2d")},w=(L,j)=>{if(!n.data.timeSegments||n.data.timeSegments.length<=0)return;const Y=n.width/n.totalMS;n.data.timeSegments.forEach(p=>{if(p.beginTime<=n.startTimestamp+n.totalMS&&p.endTime>=n.startTimestamp){M.ctx.beginPath();let W=(p.beginTime-n.startTimestamp)*Y,X;W<0?(W=0,X=(p.endTime-n.startTimestamp)*Y):X=(p.endTime-p.beginTime)*Y;let P=p.startRatio===void 0?.6:p.startRatio,A=p.endRatio===void 0?.9:p.endRatio;j?M.ctx.rect(W,M.height*P,X,M.height*(A-P)):(M.ctx.fillStyle=p.color,M.ctx.fillRect(W,M.height*P,X,M.height*(A-P))),L&&L(p)}})},D=()=>{M.ctx.clearRect(0,0,n.width,M.height)},I=()=>{m.nextTick(()=>{D(),w()})},ie=L=>{k("click",L);let{left:j,top:Y}=H.value.getBoundingClientRect(),p=L.clientX-j,W=L.clientY-Y,X=E(p,W);X.length>0&&k("click_window_timeSegments",X,n.index,n.data)},E=(L,j)=>{if(!n.data.timeSegments||n.data.timeSegments.length<=0)return[];let Y=[];return w(p=>{M.ctx.isPointInPath(L,j)&&Y.push(p)},!0),Y},N=()=>H.value?H.value.getBoundingClientRect():null;return m.onMounted(()=>{e(),w()}),Z({draw:I,getRect:N}),(L,j)=>(m.openBlock(),m.createElementBlock("div",{class:m.normalizeClass(["windowListItem",{active:a.active}]),ref_key:"windowListItem",ref:H,onClick:ie},[m.createElementVNode("span",ye,m.toDisplayString(a.index+1),1),m.createElementVNode("canvas",{class:"windowListItemCanvas",ref_key:"canvas",ref:C},null,512)],2))}}),[["__scopeId","data-v-35f19113"]]),ge=60*60*1e3,ee=[.5,1,2,6,12,24,72,360,720,8760,87600],we=[1/60,1/60,2/60,1/6,.25,.5,1,4,4,720,7200],pe=[1/20,1/30,1/20,1/3,.5,2,4,4,4,720,7200],_e=[()=>!0,a=>a.getMinutes()%5===0,a=>a.getMinutes()%10===0,a=>a.getMinutes()===0||a.getMinutes()===30,a=>a.getMinutes()===0,a=>a.getHours()%2===0&&a.getMinutes()===0,a=>a.getHours()%3===0&&a.getMinutes()===0,a=>a.getHours()%12===0&&a.getMinutes()===0,()=>!1,()=>!0,()=>!0],xe=[()=>!0,a=>a.getMinutes()%5===0,a=>a.getMinutes()%10===0,a=>a.getMinutes()===0||a.getMinutes()===30,a=>a.getHours()%2===0&&a.getMinutes()===0,a=>a.getHours()%4===0&&a.getMinutes()===0,a=>a.getHours()%3===0&&a.getMinutes()===0,a=>a.getHours()%12===0&&a.getMinutes()===0,()=>!1,()=>!0,()=>!0],Ie="",$e=fe(Object.assign({name:"TimeLine"},{__name:"TimeLine",props:{initTime:{type:[Number,String],default:""},timeRange:{type:Object,default(){return{}}},initZoomIndex:{type:Number,default:5},showCenterLine:{type:Boolean,default:!0},centerLineStyle:{type:Object,default(){return{width:2,color:"#fff"}}},textColor:{type:String,default:"rgba(151,158,167,1)"},hoverTextColor:{type:String,default:"rgb(194, 202, 215)"},lineColor:{type:String,default:"rgba(151,158,167,1)"},lineHeightRatio:{type:Object,default(){return{date:.3,time:.2,none:.1,hover:.3}}},showHoverTime:{type:Boolean,default:!0},hoverTimeFormat:{type:Function},timeSegments:{type:Array,default:()=>[]},backgroundColor:{type:String,default:"#262626"},multiSegmentActiveColor:{type:String},enableZoom:{type:Boolean,default:!0},enableDrag:{type:Boolean,default:!0},windowList:{type:Array,default:()=>[]},baseTimeLineHeight:{type:Number,default:50},initSelectWindowTimeLineIndex:{type:Number,default:-1},isMobile:{type:Boolean,default:!1},maxClickDistance:{type:Number,default:3},roundWidthTimeSegments:{type:Boolean,default:!0},customShowTime:{type:Function},showDateAtZero:{type:Boolean,default:!0},extendZOOM:{type:Array,default(){return[]}},formatTime:{type:Function}},emits:["timeChange","mousedown","dragTimeChange","mouseup","click_timeSegments","click_timeline","change_window_time_line","click_window_timeSegments"],setup(a,{expose:Z,emit:B}){const n=a,k=B,H=m.ref(null),C=m.ref(null),M=m.ref([]),e=m.reactive({width:0,height:0,ctx:null,currentZoomIndex:0,currentTime:0,startTimestamp:0,mousedown:!1,mousedownX:0,mousedownY:0,mousedownCacheStartTimestamp:0,showWindowList:!1,windowListInner:[],mousemoveX:-1,watchTimeList:[]});n.extendZOOM.forEach(t=>{ee.push(t.zoom),we.push(t.zoomHourGrid),pe.push(t.mobileZoomHourGrid)});const w=m.computed(()=>ee[e.currentZoomIndex]*ge),D=m.computed(()=>{let t={};return n.timeRange.start&&(t.start=typeof n.timeRange.start=="number"?n.timeRange.start:new Date(n.timeRange.start).getTime()),n.timeRange.end&&(t.end=typeof n.timeRange.end=="number"?n.timeRange.end:new Date(n.timeRange.end).getTime()),t}),I=m.computed(()=>n.isMobile?pe:we),ie=m.computed(()=>n.isMobile?xe:_e),E=m.computed(()=>e.currentZoomIndex===9),N=m.computed(()=>e.currentZoomIndex===10),L=()=>{e.windowListInner=n.windowList.map((t,o)=>({...t,active:n.initSelectWindowTimeLineIndex===o})),e.currentZoomIndex=n.initZoomIndex>=0&&n.initZoomIndex<ee.length?n.initZoomIndex:5,e.startTimestamp=(n.initTime?typeof n.initTime=="number"?n.initTime:new Date(n.initTime).getTime():new Date(K().format("YYYY-MM-DD 00:00:00")).getTime())-w.value/2,j()},j=()=>{let t=w.value/2,o=e.startTimestamp+t;D.value.start&&o<D.value.start&&(e.startTimestamp=D.value.start-t),D.value.end&&o>D.value.end&&(e.startTimestamp=D.value.end-t)},Y=()=>{let{width:t,height:o}=H.value.getBoundingClientRect();e.width=t,e.height=n.windowList.length>1?n.baseTimeLineHeight:o,C.value.width=e.width,C.value.height=e.height,e.ctx=C.value.getContext("2d"),e.showWindowList=!0},p=()=>{ae(),P(),X(),e.currentTime=e.startTimestamp+w.value/2,k("timeChange",e.currentTime);try{M.value.forEach(t=>{t.draw()})}catch(t){console.error(t)}W()},W=()=>{e.watchTimeList.forEach(t=>{if(t.time<e.startTimestamp||t.time>e.startTimestamp+w.value)t.callback(-1,-1);else{let o=(t.time-e.startTimestamp)*(e.width/w.value),c=0,{left:f,top:_}=C.value.getBoundingClientRect();if(t.windowTimeLineIndex!==-1&&n.windowList.length>1&&t.windowTimeLineIndex>=0&&t.windowTimeLineIndex<n.windowList.length){let v=M.value[t.windowTimeLineIndex].getRect();c=v?v.top:_}else c=_;t.callback(o+f,c)}})},X=()=>{if(!n.showCenterLine)return;e.ctx.beginPath();let{width:t,color:o}=n.centerLineStyle,c=e.width/2;U(c,0,c,e.height,t,o)},P=()=>{e.ctx.beginPath();let t=ee[e.currentZoomIndex]/I.value[e.currentZoomIndex],o=I.value[e.currentZoomIndex]*ge,c=e.width/t,f=o-e.startTimestamp%o,_=f/o*c;for(let v=0;v<t;v++){let O=e.startTimestamp+f+v*o,J=0;N.value?J=O-new Date(`${K(O).format("YYYY")}-01-01 00:00:00`).getTime():E.value&&(J=O-new Date(`${K(O).format("YYYY")}-${K(O).format("MM")}-01 00:00:00`).getTime());let ne=_+v*c-J/o*c,me=O-J,se=0,de=new Date(me);n.showDateAtZero&&de.getHours()===0&&de.getMinutes()===0?(se=e.height*(n.lineHeightRatio.date===void 0?.3:n.lineHeightRatio.date),e.ctx.fillStyle=n.textColor,e.ctx.fillText(z(me),ne-13,se+15)):A(de)?(se=e.height*(n.lineHeightRatio.time===void 0?.2:n.lineHeightRatio.time),e.ctx.fillStyle=n.textColor,e.ctx.fillText(z(me),ne-13,se+15)):se=e.height*(n.lineHeightRatio.none===void 0?.1:n.lineHeightRatio.none),U(ne,0,ne,se,1,n.lineColor)}},A=t=>{if(n.customShowTime){let o=n.customShowTime(t,e.currentZoomIndex);if(o===!0)return!0;if(o===!1)return!1}return ie.value[e.currentZoomIndex](t)},ae=(t,o)=>{const c=e.width/w.value;n.timeSegments.forEach(f=>{if(f.beginTime<=e.startTimestamp+w.value){let _=f.endTime>=e.startTimestamp;e.ctx.beginPath();let v=(f.beginTime-e.startTimestamp)*c,O;v<0?(v=0,O=_?(f.endTime-e.startTimestamp)*c:1):O=_?(f.endTime-f.beginTime)*c:1;let J=f.startRatio===void 0?.6:f.startRatio,ne=f.endRatio===void 0?.9:f.endRatio;n.roundWidthTimeSegments&&(v=Math.round(v),O=Math.round(O)),O=Math.max(1,O),o?e.ctx.rect(v,e.height*J,O,e.height*(ne-J)):(e.ctx.fillStyle=f.color,e.ctx.fillRect(v,e.height*J,O,e.height*(ne-J))),t&&t(f)}})},ue=t=>{n.isMobile&&(t=t.touches[0],S(t))},re=t=>{n.isMobile||S(t)},S=t=>{let o=$(t);t.target.style.cursor="grabbing",e.mousedownX=o[0],e.mousedownY=o[1],e.mousedown=!0,e.mousedownCacheStartTimestamp=e.startTimestamp,k("mousedown",t)};let g=t=>{n.isMobile&&(t=t.touches[0],le(t))},V=t=>{n.isMobile||le(t)};const le=t=>{t.target.style.cursor="pointer";let o=$(t);const c=()=>{e.mousedown=!1,e.mousedownX=0,e.mousedownY=0,e.mousedownCacheStartTimestamp=0};if(Math.abs(o[0]-e.mousedownX)<=n.maxClickDistance&&Math.abs(o[1]-e.mousedownY)<=n.maxClickDistance){c(),y(...o);return}e.mousedown&&n.enableDrag?(c(),k("dragTimeChange",e.currentTime)):c(),k("mouseup",t)},l=t=>{n.isMobile&&(t=t.touches[0],i(t))},s=t=>{n.isMobile||i(t)},i=t=>{let o=$(t)[0];e.mousemoveX=o,e.mousedown&&n.enableDrag?r(o):n.showHoverTime&&d(o)},u=()=>{e.mousemoveX=-1},r=t=>{if(!n.enableDrag)return;const o=e.width/w.value;let c=t-e.mousedownX,f=w.value/2,_=e.mousedownCacheStartTimestamp-Math.round(c/o),v=_+f;D.value.start&&v<D.value.start&&(_=D.value.start-f),D.value.end&&v>D.value.end&&(_=D.value.end-f),e.startTimestamp=_,b(e.width,e.height),p()},d=(t,o)=>{const c=e.width/w.value;let f=e.startTimestamp+t/c;o||(b(e.width,e.height),p());let _=e.height*(n.lineHeightRatio.hover===void 0?.3:n.lineHeightRatio.hover);U(t,0,t,_,1,n.lineColor),e.ctx.fillStyle=n.hoverTextColor;let v=n.hoverTimeFormat?n.hoverTimeFormat(f):K(f).format("YYYY-MM-DD HH:mm:ss"),O=e.ctx.measureText(v).width;e.ctx.fillText(v,t-O/2,_+20)},h=()=>{b(e.width,e.height),p()},T=t=>{if(!n.enableZoom)return;let o=window.event||t,c=Math.max(-1,Math.min(1,o.wheelDelta||-o.detail));c<0?e.currentZoomIndex+1>=ee.length-1?e.currentZoomIndex=ee.length-1:e.currentZoomIndex++:c>0&&(e.currentZoomIndex-1<=0?e.currentZoomIndex=0:e.currentZoomIndex--),b(e.width,e.height),e.startTimestamp=e.currentTime-w.value/2,p()},y=(t,o)=>{const c=e.width/w.value;let f=e.startTimestamp+t/c,_=K(f).format("YYYY-MM-DD HH:mm:ss"),v=x(t,o);v&&v.length>0?k("click_timeSegments",v,f,_,t):Ce(f,_,t)},x=(t,o)=>{let c=[];return ae(f=>{e.ctx.isPointInPath(t,o)&&c.push(f)},!0),c},$=t=>{if(!H.value||!t)return[0,0];let{left:o,top:c}=H.value.getBoundingClientRect();return[t.clientX-o,t.clientY-c]},b=(t,o)=>{e.ctx.clearRect(0,0,t,o)},z=t=>{let o=K(t),c="";return n.formatTime&&(c=n.formatTime(o)),c||(N.value?o.format("YYYY"):E.value?o.format("YYYY-MM"):o.hour()===0&&o.minute()===0&&o.millisecond()===0?o.format("MM-DD"):o.format("HH:mm"))},U=(t,o,c,f,_=1,v="#fff")=>{e.ctx.beginPath(),e.ctx.strokeStyle=v,e.ctx.lineWidth=_,e.ctx.moveTo(t,o),e.ctx.lineTo(c,f),e.ctx.stroke()},q=()=>{m.nextTick(()=>{b(e.width,e.height),G(),L(),Y(),p()})},G=()=>{e.width=0,e.height=0,e.ctx=null,e.currentZoomIndex=0,e.currentTime=0,e.startTimestamp=0,e.mousedown=!1,e.mousedownX=0,e.mousedownCacheStartTimestamp=0},R=t=>{if(e.mousedown)return;let o=typeof t=="number"?t:new Date(t).getTime();e.startTimestamp=o-w.value/2,j(),b(e.width,e.height),p(),e.mousemoveX!==-1&&!n.isMobile&&d(e.mousemoveX,!0)},F=(t,o,c)=>{k("click_window_timeSegments",t,o,c)},te=t=>{e.currentZoomIndex=t>=0&&t<ee.length?t:5,b(e.width,e.height),e.startTimestamp=e.currentTime-w.value/2,p()},oe=t=>{e.windowListInner.forEach(o=>{o.active=!1}),e.windowListInner[t].active=!0,k("change_window_time_line",t,e.windowListInner[t])},De=(t,o,c)=>{!t||!o||e.watchTimeList.push({time:typeof t=="number"?t:new Date(t).getTime(),callback:o,windowTimeLineIndex:typeof c=="number"?c-1:-1})},Le=()=>{W()};let ce=()=>{Y(),p();try{M.value.forEach(t=>{t.init()})}catch(t){console.error(t)}};const Ce=(...t)=>{k("click_timeline",...t)};return m.watch(()=>n.timeSegments,q,{deep:!0}),m.onMounted(()=>{L(),Y(),p(),V=V.bind(this),ce=ce.bind(this),g=g.bind(this),n.isMobile?window.addEventListener("touchend",g):window.addEventListener("mouseup",V),window.addEventListener("resize",ce)}),m.onBeforeUnmount(()=>{n.isMobile?window.removeEventListener("touchend",g):window.removeEventListener("mouseup",V),window.removeEventListener("resize",ce)}),Z({setTime:R,setZoom:te,watchTime:De,reRender:q}),(t,o)=>(m.openBlock(),m.createElementBlock("div",{class:"timeLineContainer",ref_key:"timeLineContainer",ref:H,style:m.normalizeStyle({backgroundColor:a.backgroundColor}),onTouchstart:ue,onTouchmove:l,onMousedown:re,onMouseout:h,onMousemove:s,onMouseleave:u},[m.createElementVNode("canvas",{class:"canvas",ref_key:"canvas",ref:C,onMousewheel:m.withModifiers(T,["stop","prevent"])},null,544),e.showWindowList&&a.windowList&&a.windowList.length>1?(m.openBlock(),m.createElementBlock("div",{key:0,class:"windowList",ref:"windowList",onScroll:Le},[(m.openBlock(!0),m.createElementBlock(m.Fragment,null,m.renderList(e.windowListInner,(c,f)=>(m.openBlock(),m.createBlock(Se,{ref_for:!0,ref_key:"WindowListItemRef",ref:M,key:f,index:f,data:c,totalMS:w.value,startTimestamp:e.startTimestamp,width:e.width,active:c.active,multiSegmentActiveColor:a.multiSegmentActiveColor,onClick_window_timeSegments:F,onClick:_=>oe(f)},null,8,["index","data","totalMS","startTimestamp","width","active","multiSegmentActiveColor","onClick"]))),128))],544)):m.createCommentVNode("",!0)],36))}}),[["__scopeId","data-v-55d6c60f"]]),be={install(a,Z){const B=Z!=null&&Z.comName?Z==null?void 0:Z.comName:"TimeLine";a.component(B,$e)}};Q.default=be,Object.defineProperties(Q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
